!function(e){"use strict";e.fn.multiAccordion=function(){e(this).addClass("ui-accordion ui-accordion-icons ui-widget ui-helper-reset").find("h3").addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-top ui-corner-bottom").hover(function(){e(this).toggleClass("ui-state-hover")}).prepend('<span class="ui-icon ui-icon-triangle-1-e"></span>').click(function(){return e(this).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").find("> .ui-icon").toggleClass("ui-icon-triangle-1-e ui-icon-triangle-1-s").end().next().toggleClass("ui-accordion-content-active").slideToggle(100),!1}).next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").css("display","block").hide().end().trigger("click")}}(jQuery),function(e){"use strict";var t={timer:0,submit:"#wpa-submit",message:function(n,i){var a=e(".wpa-message-"+n);i&&a.html(i);var o="message-aleady";a.fadeIn(),clearTimeout(t.timer),a.hasClass(o)||(t.timer=setTimeout(function(){a.fadeOut("500")},800))},init:function(){window.addEventListener("hashchange",t.changeOnHash,!1),e(".acoordion").multiAccordion({animate:100,autoHeight:!1,heightStyle:"content"}),e("#wpa_tabs").tabs({hide:{effect:"fadeOut",duration:200},show:{effect:"fadeIn",duration:200}}).addClass("ui-tabs-vertical ui-helper-clearfix"),e("#wpa_tabs ul li a").on("click",function(){location.hash=e(this).attr("href"),window.scrollTo(0,0)}),e(".form-group-radiobox").buttonset(),e("#wpa-submit").attr("disabled","disabled"),t.event()},submit_enhanced:function(){e(t.submit).removeAttr("disabled")},changeOnHash:function(){var t=location.hash;e("#wpa_tabs").tabs("enable",t).addClass("ui-tabs-vertical ui-helper-clearfix")},updateOption:function(n){if(n.preventDefault(),!1===t.submit_flag)return!1;t.submit_flag=!1;var i=e(this);e("#wpa_tabs ul").find(".spinner").show();var a=e("#wpa_settings_form").serializeArray();_.each(a,function(e,t){e.name.match(/wpa_supports_check/)&&delete a[t]}),e.ajax({type:"post",url:ajaxurl,data:{action:wpaSETTINGS.action,_wp_nonce:wpaSETTINGS._wp_nonce,form:a},success:function(n){1==n?(e("#wpa_tabs ul").find(".spinner").hide(),t.message("success"),i.attr("disabled","disabled")):3==n?(e("#wpa_tabs ul").find(".spinner").hide(),t.message("no-update"),i.attr("disabled","disabled")):(e("#wpa_tabs ul").find(".spinner").hide(),t.message("faild")),t.submit_flag=!0}})},openMediaUpload:function(e,n){n.preventDefault();var i=null;return i?(i.open(),!1):(i=wp.media.frames.file_frame=wp.media({title:e.data("uploader_title"),button:{text:e.data("uploader_button_text")},multiple:!1}),i.on("select",function(){var n=i.state().get("selection").first().toJSON();t.submit_enhanced(),e.prev(".wpa-url").val(n.url)}),void i.open())},event:function(){e(document).on("click",t.submit,function(e){t.updateOption(e)}),e(document).on("click",".wpa-browse",function(n){t.openMediaUpload(e(this),n)}),e(document).change(function(){t.submit_enhanced()})}};e(function(){t.init()})}(jQuery),function(e){"use strict";e(function(){var t=e("#wpadashboard");e("#dashboard-widgets-wrap").prepend(t),e("#wpa_dashboard_widget").remove()})}(jQuery),function(e){"use strict";var t={insertTarget:"#wpa_admin_menus_list",saveHiddenInput:"#admin_menu_hidden",checkedMenus:"#wpa_admin_menus .adminmenu_hidden_check",menuListTemplateID:"#wpa_admin_menus_template",adminMenu:"#adminmenu > li",update:function(){var n=(e(t.checkedMenus),e(".menu-list-item-text_input")),i="",a=0;e.each(n,function(){{var n=e(this).data("menu-id"),o=e(this).closest(".menu-list-item"),u=e(this).val().replace(/\s+/g,"+"),r=o.find(".adminmenu_hidden_check").attr("checked")?0:1,s=o.find(".menu-list-item-target_input").val()?o.find(".menu-list-item-target_input").val():"",d=t.utf8_to_b64(e(this).closest(".menu-list-item").find(".menu-list-item-link_input").val());e(this).closest(".menu-list-item").data("order")}u&&(0===a?(i+=a+"id="+n,i+="&"+a+"text="+u,i+="&"+a+"link="+d,i+="&"+a+"disp="+r,i+="&"+a+"target="+s,i+="&"+a+"order="+a):(i+="&"+a+"id="+n,i+="&"+a+"text="+u,i+="&"+a+"link="+d,i+="&"+a+"disp="+r,i+="&"+a+"target="+s,i+="&"+a+"order="+a),a++)}),e(t.saveHiddenInput).val(i)},deparam:function(n){n=n.substring(n.indexOf("?")+1).split("&");var i,a,o,u={},r=decodeURIComponent;for(o=0;o<n.length;o++)u[o]={};for(a=n.length;a>0;)if(i=n[--a].split("="),i[0]&&"undefined"!==i[0]){var s=i[0];if(!s.match(/\d/g))return u;var d=s.match(/\d/g).join("").trim(),l=r(i[0].match(/\D/g).join(""));"link"==l?u[parseInt(d)][l]=r(i[1].replace(/\+/g," "))?t.b64_to_utf8(r(i[1].replace(/\+/g," "))):r(i[1].replace(/\+/g," ")):"undefined"!=typeof u[parseInt(d)]&&r(i[1].replace(/\+/g," "))&&(u[parseInt(d)][l]=r(i[1].replace(/\+/g," ")))}return e.each(u,function(e){"undefined"==typeof this.id&&delete u[e]}),u},getTarget:function(){return e(t.insertTarget)},getOriginalMenu:function(){return e(adminMenu)},getOriginalMenuArray:function(){var n=t.getOriginalMenu(),i={};return"undefined"==typeof n?!1:(e.each(n,function(t,n){e(this).find(".wp-menu-name").find(".pending-count").remove(),e(this).find(".wp-menu-name").find(".plugin-count").remove();var a=e(this).find(".wp-menu-name").text(),o=e(this).attr("id");i[t]={title:a,id:o}}),i)},setTemplate:function(){t.template=_.template(e(t.menuListTemplateID).html())},getMenus:function(){return{menus:t.getOriginalMenuArray()}},formatMenu:function(e){},getData:function(e){var n=t.deparam(e);return n=_.sortBy(n,function(e){return parseInt(e.order)}),{menus:n}},randomstring:function(e){for(var t="",n=function(){var e=Math.floor(62*Math.random());return 10>e?e:String.fromCharCode(36>e?e+55:e+61)};t.length<e;)t+=n();return t},init:function(n){var i=t;if(t.settings=n,e(t.menuListTemplateID).length){i.setTemplate(),t.cloneMenu();var a=t.defaults(t.originalAdminMenu),o=n.menus?n.menus:a;t.enhanced(i.getData(o));var u=i.compiled(i.getData(o));i.getTarget().html(u),t.update(),t.event()}else{var a=t.defaults(),o=n.menus||a;t.enhanced(i.getData(o))}e("#admin-menu-hide-css").remove()},cloneMenu:function(){return t.originalAdminMenu=e("#adminmenu").clone(),t.originalAdminMenu},compiled:function(e){return t.template(e)},enhanced:function(n){var i=e("#adminmenu").clone();e("#adminmenu").attr("id","adminmenu_original").hide(),e("#adminmenuwrap").append(i),_.each(n.menus,function(e,n){if(!e.id)return!1;0==i.find("#"+e.id).length&&i.find("#collapse-menu").before('<li id="'+e.id+'" class=" menu-top menu-icon-generic menu-top-first menu-top-last"><a href="" class=" menu-top menu-icon-generic menu-top-first menu-top-last"><div class="wp-menu-image dashicons-before dashicons-admin-generic"><br></div> <div class="wp-menu-name">'+e.text+"</div></a></li>");var a=i.find("#"+e.id);"undefined"!=typeof e.link&&a.children("a").attr("href",e.link),"undefined"!=typeof e.target&&a.children("a").attr("target",e.target),t.settings.user.userflag===!0&&0==e.disp&&a.remove(),a.find(".wp-menu-name").text(e.text),a.attr("data-order",e.order)}),i.html(_.sortBy(i.children(),function(t){return parseInt(e(t).data("order"))}))},utf8_to_b64:function(e){return window.btoa(unescape(encodeURIComponent(e)))},b64_to_utf8:function(e){return decodeURIComponent(escape(window.atob(e)))},defaults:function(n){var i="",a=0,o=t.originalAdminMenu||_.clone(e(t.adminMenu));return o.children("li").each(function(){var n=e(this).attr("id"),o=e(this).find(".wp-menu-name"),u="",r=e(this).children("a").attr("href")?e(this).children("a").attr("href"):"",s=r?t.utf8_to_b64(r):" ";o.find(".pending-count").remove(),o.find(".plugin-count").remove();var d=e(this).find(".wp-menu-name").text().replace(/(^\s+)|(\s+$)/g,"");d&&(0===a?(i+=a+"id="+n,i+="&"+a+"text="+d,i+="&"+a+"link="+s,i+="&"+a+"target="+u,i+="&"+a+"disp=1",i+="&"+a+"order="+a):(i+="&"+a+"id="+n,i+="&"+a+"link="+s,i+="&"+a+"text="+d,i+="&"+a+"disp=1",i+="&"+a+"target="+u,i+="&"+a+"order="+a)),a++}),console.log(i),i},sortableInit:function(){e("#wpa_admin_menus").sortable({placeholder:"ui-state-highlight",update:function(n,i){e(this).find(".menu-list-item").each(function(n,i){e(i).attr("data-order",n),setTimeout(function(){t.update()},500)})}})},restoreDefaultMenu:function(){var n=t.defaults(t.originalAdminMenu);e(t.saveHiddenInput).val(n);var i=t.compiled(t.getData(n));t.getTarget().html(i)},removeDisable:function(){e("#wpa-submit").removeAttr("disabled")},event:function(){e(document).on("click","#wpa_admin_menus input",function(){t.update()}),e(document).on("click","#wpa_admin_menu_reset",function(n){n.preventDefault();var i=_.template(e("#wpa_admin_menu_dialog").html()),a=i({title:t.settings.dialog.title,context:t.settings.dialog.context});e(t.menuListTemplateID).after(a),e("#admin_menu_dialog").dialog({resizable:!1,width:500,height:440,modal:!0,buttons:{OK:function(){t.restoreDefaultMenu(),t.sortableInit(),e(this).dialog("close")},Cancel:function(){e(this).dialog("close")}}}),t.removeDisable()}),e(document).on("click",'#wpa_admin_menus input[type="checkbox"]',function(){var n=e(this).next().next().data("menu-id"),i=e(this).attr("checked");"checked"===i?e("#"+n).fadeOut():e("#"+n).fadeIn(),t.removeDisable()}),e(document).on("click",".menu-list-item-text",function(n){var i=e(this).closest(".menu-list-item"),a=i.find(".menu-list-item-text_input,.menu-list-item-link_input");i.hasClass("on")?e(this).next(".menu-list-item-text_input").attr("class")!==e(n.target).attr("class")&&(i.removeClass("on"),i.find(".wpa_input-group").addClass("hide"),e(this).text(a.val()),e(this).show(),i.find("button").hide(),a.hide(),t.removeDisable()):(i.addClass("on"),i.find(".wpa_input-group").removeClass("hide"),a.show(),i.find("button").show())}),e(document).on("click",".menu-list-item-remove",function(t){t.preventDefault();var n=e(this).closest(".menu-list-item");n.fadeOut("500"),setTimeout(function(){n.remove()},500)}),e(document).on("click",".menu-list-item-text-save",function(n){n.preventDefault();var i=e(this).closest(".menu-list-item"),a=i.find(".menu-list-item-text_input").val();i.find(".menu-list-item-text").fadeOut().text(a).fadeIn(),i.find(".wpa_input-group").addClass("hide");var o=e(this).prev().data("menu-id");e("#"+o).find(".wp-menu-name").fadeOut().text(a).fadeIn(),e(this).hide(),i.removeClass("on"),t.update(),t.removeDisable()}),e(document).on("click","#add_menu_list_item",function(n){n.preventDefault();var i=_.template(e("#wpa_admin_menu_template").html()),a=i({menu:{order:20,text:" ",id:t.randomstring(8),disp:1}});e(t.insertTarget).append(a)}),e(".menu-list-item-text_input").on("keydown keyup keypress change",function(){e(this).closest(".menu-list-item").find(".menu-list-item-text").text(e(this).val())})}};e(function(){if("undefined"==typeof wpa_ADMIN_MENU)return!1;var n=wpa_ADMIN_MENU||{};t.init(n),e("body").hasClass("toplevel_page_wpa_options_page")&&e("#wpa_admin_menus").sortable({placeholder:"ui-state-highlight",update:function(n,i){e(this).find(".menu-list-item").each(function(n,i){e(i).attr("data-order",n),setTimeout(function(){t.update()},500)}),wp}})})}(jQuery),function(e){function t(t){return t?(t=e(".post-count-"+t),void t.text("0")):!1}var n,i=function(t,i){var a=e(".wpa-message-"+t);i&&a.html(i);var o="message-aleady";a.fadeIn(),clearTimeout(n),a.hasClass(o)||(n=setTimeout(function(){a.fadeOut("500")},800))},a=!0;e(document).on("click","#optimize_submit",function(n){if(n.preventDefault(),!1===a)return!1;var o=(e("#wpa_optimize"),{revision:e('input[name="optimize_revision"]:checked').val(),auto_draft:e('input[name="optimize_auto_draft"]:checked').val(),trash:e('input[name="optimize_trash"]:checked').val()});a=!1;var u=e("#optimize_nonce").val();e(".run_optimize").find(".spinner").show(),e.ajax({type:"post",url:ajaxurl,data:{action:"run_optimize",_wp_optimize_nonce:u,selected_action:o},success:function(n){if(e(".run_optimize").find(".spinner").hide(),"faild"==n.status)i("faild","<h3>"+n.html+"</h3>");else{var o=document.createElement("div"),u=document.createElement("h3");n.optimize_revision&&(e(o).append(e(u).text(e(u).text()+n.optimize_revision)),t("revision")),n.optimize_auto_draft&&(e(o).append(e(u).text(e(u).text()+n.optimize_auto_draft)),t("auto_draft")),n.optimize_trash&&(e(o).append(e(u).text(e(u).text()+n.optimize_trash)),t("trash")),e(o).length>0&&i("optimize",e(o))}a=!0}})})}(jQuery),function(e){"use strict";var t="#tools_option_import",n="tools_option_import_file",i="#tools_option_import_data";e(document).on("change","#"+n,function(){var t=new FileReader,a=document.getElementById(n).files[0];t.onload=function(){e(i).val(t.result)},t.readAsText(a)}),e(document).on("click",t,function(t){t.preventDefault();var n=e(i).val(),a=/^a:.*;}$/;if(!n.match(a))return alert("有効なファイルではありません。ファイルが正しいか確認してください。"),!1;var o=e("#tools_option_import_nonce").val();e.ajax({type:"post",url:ajaxurl,data:{action:"wpa_option_import",wp_import_nonce:o,import_data:n},success:function(e){return console.log(e),"1"===e?(alert("オプションを更新しました"),location.reload(),!0):void 0}})})}(jQuery);